<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Painel de Curadoria - NeuroArte DAO</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script defer>
    let currentWallet = null;
    const allowedCurators = [
  "0xE9eFC721405e1026B1ee91C07B2534e1796632A4",
   "0x59a42f0b0a6c5e0ab24c09fa4101d2df85d3e391"   
  // adicione outras wallets aqui
].map(w => w.toLowerCase());


    async function connectWallet() {
      if (typeof window.ethereum !== "undefined") {
        try {
          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
          currentWallet = accounts[0];
          document.getElementById("walletStatus").textContent = `Wallet conectada: ${currentWallet}`;
          checkAccess();
        } catch (error) {
          document.getElementById("walletStatus").textContent = "Conex√£o recusada.";
        }
      } else {
        document.getElementById("walletStatus").textContent = "Instale a MetaMask para conectar.";
      }
    }

    function checkAccess() {
      const approveButtons = document.querySelectorAll(".approve-btn");
       if (currentWallet && allowedCurators.includes(currentWallet.toLowerCase())) {
        approveButtons.forEach(btn => btn.disabled = false);
      } else {
        approveButtons.forEach(btn => {
          btn.disabled = true;
          btn.title = "Apenas a wallet oficial da curadoria pode aprovar.";
        });
      }
    }
  </script>
</head>
<body class="bg-gradient-to-br from-black via-gray-900 to-purple-900 text-white font-sans">
  <header class="text-center py-4">
    <h1 class="text-3xl font-bold">üñãÔ∏è Painel de Curadoria</h1>
    <p class="text-sm">Revis√£o das obras submetidas √† NeuroArte DAO</p>
    <div class="mt-2">
      <a href="index.html" class="underline text-purple-400">üè† In√≠cio</a>
      <a href="artist_portal_page.html" class="underline text-purple-400 ml-4">üßë‚Äçüé® Portal do Artista</a>
      <a href="curadoria_portal_page.html" class="underline text-purple-400 ml-4">üñãÔ∏è Curadoria</a>
    </div>
    <div class="mt-4">
      <button onclick="connectWallet()" class="bg-purple-700 px-4 py-2 rounded">üîå Conectar Wallet</button>
      <p id="walletStatus" class="text-sm mt-1 text-gray-300"></p>
    </div>
  </header>

  <main class="max-w-3xl mx-auto p-4">
  <section class="bg-gray-900 p-6 rounded-xl shadow-lg">
    <h2 class="text-xl font-bold mb-4 flex items-center">
      üñºÔ∏è <span class="ml-2">Obras Submetidas</span>
    </h2>
    <div id="artworksContainer">
      <!-- Obras ser√£o carregadas aqui via JS -->
    </div>
  </section>
</main>

  <script>
    const submittedArtworks = [
  {
    title: "Neuroesfera I",
    editions: 25,
    artistWallet: "0x123...abc",
    votes: { yes: 2, no: 1 },
  },
  {
    title: "C√©rebro C√≥smico",
    editions: 10,
    artistWallet: "0x456...def",
    votes: { yes: 0, no: 0 },
  },
];

function renderArtworks() {
  const container = document.getElementById("artworksContainer");
  container.innerHTML = "";

  submittedArtworks.forEach((artwork, index) => {
    const card = document.createElement("div");
    card.className = "bg-gray-800 p-4 rounded-lg border border-purple-600 mb-4";

    card.innerHTML = `
      <p class="text-lg font-semibold">${artwork.title}</p>
      <p class="text-sm text-gray-400">Edi√ß√µes: ${artwork.editions} | Wallet: ${artwork.artistWallet}</p>
      <div class="flex justify-between mt-2">
        <div>
          <span class="text-green-400">‚úîÔ∏è ${artwork.votes.yes}</span>
          <span class="text-red-400 ml-4">‚ùå ${artwork.votes.no}</span>
        </div>
        <div>
          <button class="approve-btn bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded mr-2" data-index="${index}">Aprovar</button>
          <button class="reject-btn bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded" data-index="${index}">Rejeitar</button>
        </div>
      </div>
    `;

    container.appendChild(card);
  });

  attachVoteHandlers();
}

function attachVoteHandlers() {
  document.querySelectorAll(".approve-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const i = btn.dataset.index;
      submittedArtworks[i].votes.yes++;
      renderArtworks();
    });
  });

  document.querySelectorAll(".reject-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const i = btn.dataset.index;
      submittedArtworks[i].votes.no++;
      renderArtworks();
    });
  });

  checkAccess(); // Restringe os bot√µes a wallets autorizadas
}

window.addEventListener("load", () => {
  checkWalletAccess();
  renderArtworks();
});

  // Lista de wallets autorizadas (pode expandir depois)
  const allowedCurators = [
    "0xE9eFC721405e1026B1ee91C07B2534e1796632A4".toLowerCase()
  ];

  // Verifica se o usu√°rio est√° conectado e autorizado
  async function checkWalletAccess() {
    if (typeof window.ethereum === 'undefined') {
      alert("MetaMask n√£o detectado. Instale para acessar.");
      window.location.href = "index.html";
      return;
    }

    try {
      const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
      const userWallet = accounts[0].toLowerCase();

      if (!allowedCurators.includes(userWallet)) {
        alert("Acesso restrito √† curadoria. Wallet n√£o autorizada.");
        window.location.href = "index.html";
      }
    } catch (err) {
      alert("Erro ao conectar √† wallet.");
      window.location.href = "index.html";
    }
  }

  window.addEventListener('load', checkWalletAccess);
</script>

</body>
</html>
